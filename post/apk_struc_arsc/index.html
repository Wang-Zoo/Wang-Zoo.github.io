<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Apk 结构详解(1) - WangZoo - 码字坞</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="WangZoo" />
  <meta name="description" content="前言 Resource.arsc 在apk中，resource.arsc文件储存那些被编译的资源，以及没有被编译的资源的访问路径。resource文件由结构紧凑的二进制" />

  <meta name="keywords" content="Hugo, theme, jane" />






<meta name="generator" content="Hugo 0.55.5" />


<link rel="canonical" href="https://wang-zoo.github.io/post/apk_struc_arsc/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="Apk 结构详解(1)" />
<meta property="og:description" content="前言 Resource.arsc 在apk中，resource.arsc文件储存那些被编译的资源，以及没有被编译的资源的访问路径。resource文件由结构紧凑的二进制" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://wang-zoo.github.io/post/apk_struc_arsc/" />
<meta property="article:published_time" content="2020-01-06T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2020-01-06T00:00:00&#43;00:00"/>

<meta itemprop="name" content="Apk 结构详解(1)">
<meta itemprop="description" content="前言 Resource.arsc 在apk中，resource.arsc文件储存那些被编译的资源，以及没有被编译的资源的访问路径。resource文件由结构紧凑的二进制">


<meta itemprop="datePublished" content="2020-01-06T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-01-06T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="4068">



<meta itemprop="keywords" content="apk,插件化,resource.arsc," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Apk 结构详解(1)"/>
<meta name="twitter:description" content="前言 Resource.arsc 在apk中，resource.arsc文件储存那些被编译的资源，以及没有被编译的资源的访问路径。resource文件由结构紧凑的二进制"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">码字坞</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://wang-zoo.github.io/">This is Home</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://wang-zoo.github.io/post/">Archives</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://wang-zoo.github.io/tags/">Tags</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://wang-zoo.github.io/categories/">Categories</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://wang-zoo.github.io/about/">About</a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      码字坞
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://wang-zoo.github.io/">This is Home</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://wang-zoo.github.io/post/">Archives</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://wang-zoo.github.io/tags/">Tags</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://wang-zoo.github.io/categories/">Categories</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://wang-zoo.github.io/about/">About</a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">Apk 结构详解(1)</h1>
      
      <div class="post-meta">
        <time datetime="2020-01-06" class="post-time">
          2020-01-06
        </time>
        
        

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Table of Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#前言-resource-arsc">前言 Resource.arsc</a></li>
<li><a href="#1-结构概览">1.结构概览</a></li>
<li><a href="#2-头部">2.头部</a>
<ul>
<li><a href="#2-1头部概念">2.1头部概念</a></li>
<li><a href="#2-2大小端">2.2大小端</a></li>
</ul></li>
<li><a href="#3-资源头部-resource-header">3.资源头部 Resource_Header</a></li>
<li><a href="#4-字符串资源池-global-string-pool">4.字符串资源池 Global_String_Pool</a></li>
<li><a href="#5-资源详情-package">5.资源详情 Package</a>
<ul>
<li><a href="#5-1-资源详情头部-package-header">5.1 资源详情头部 Package_Header</a></li>
<li><a href="#5-2-资源字符信息池">5.2 资源字符信息池</a>
<ul>
<li><a href="#5-2-1-资源类型字符串池-res-type-string-pool">5.2.1 资源类型字符串池 Res_Type_String_Pool</a></li>
<li><a href="#5-2-2-资源项名称字符串池-res-name-string-pool">5.2.2 资源项名称字符串池 Res_Name_String_Pool</a></li>
</ul></li>
<li><a href="#5-3-资源配置">5.3 资源配置</a>
<ul>
<li><a href="#5-3-1-资源-type-spec">5.3.1 资源 Type_Spec</a></li>
<li><a href="#5-3-2-资源-typeconfig">5.3.2 资源 TypeConfig</a></li>
</ul></li>
</ul></li>
<li><a href="#总结">总结</a></li>
</ul></li>
</ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      

<h2 id="前言-resource-arsc">前言 Resource.arsc</h2>

<p>在apk中，resource.arsc文件储存那些被编译的资源，以及没有被编译的资源的访问路径。resource文件由结构紧凑的二进制编码,分析时需要特别注意细节。
本篇着重对resource.arsc做拆分，弄清楚每块的含义。</p>

<h2 id="1-结构概览">1.结构概览</h2>


<link rel="stylesheet" href="/css/hugo-easy-gallery.css" />
<div class="box">
<figure  itemprop="associatedMedia"
  itemscope itemtype="http://schema.org/ImageObject" >
    <div class="img">
      <img itemprop="thumbnail" src="/imgs/apk_arsc_struc.png" />
    </div>
    <a href="/imgs/apk_arsc_struc.png" itemprop="contentUrl"></a>
      <figcaption><h4>文件结构</h4>
      </figcaption>
  </figure>
</div>


<p>针对网上流传的关于resource.arsc，我在这里做了一个细分，让结构更加清晰。一个Resource大体由三部分组成，Resource_Header记录文件一些重要信息，主要是大小；
Global_String_Pool记录了应用中所有的字符串，包括res文件夹下的字符串值；Packages是文件的主体，里面存储了编译过的资源的索引，提供了应用在不同场景下的不同配置值，其实就是对res文件夹下的适配方案做了一个映射编排，详情下文继续分析。</p>

<h2 id="2-头部">2.头部</h2>

<h3 id="2-1头部概念">2.1头部概念</h3>



<div class="box">
<figure  itemprop="associatedMedia"
  itemscope itemtype="http://schema.org/ImageObject" >
    <div class="img">
      <img itemprop="thumbnail" src="/imgs/apk_arsc_header.png" />
    </div>
    <a href="/imgs/apk_arsc_header.png" itemprop="contentUrl"></a>
      <figcaption><h4>块头部</h4>
      </figcaption>
  </figure>
</div>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-C++" data-lang="C++"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-C++" data-lang="C++"><span class="k">struct</span> <span class="n">ResChunk_header</span> <span class="p">{</span>
	<span class="n">uint16_t</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">uint16_t</span> <span class="n">headerSize</span><span class="p">;</span>
	<span class="n">uint32_t</span> <span class="n">size</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div>
<p>前面我们的结构概图中呈现的元素我们称之为Chunk（块），每个Chunk都有一个头部，且每个头部的信息都不一样，但是每个头部的头几位数据是一致，就是上图“块头部”。
一个块头部有三个数据区域，第一位type表示这个Chunk属于什么类型，具体分类如下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-C++" data-lang="C++"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-C++" data-lang="C++"><span class="k">enum</span> <span class="p">{</span>
    <span class="n">RES_NULL_TYPE</span>               <span class="o">=</span> <span class="mh">0x0000</span><span class="p">,</span>
    <span class="n">RES_STRING_POOL_TYPE</span>        <span class="o">=</span> <span class="mh">0x0001</span><span class="p">,</span>
    <span class="n">RES_TABLE_TYPE</span>              <span class="o">=</span> <span class="mh">0x0002</span><span class="p">,</span>
    <span class="n">RES_XML_TYPE</span>                <span class="o">=</span> <span class="mh">0x0003</span><span class="p">,</span>
    <span class="c1">// Chunk types in RES_XML_TYPE
</span><span class="c1"></span>    <span class="n">RES_XML_FIRST_CHUNK_TYPE</span>    <span class="o">=</span> <span class="mh">0x0100</span><span class="p">,</span>
    <span class="n">RES_XML_START_NAMESPACE_TYPE</span><span class="o">=</span> <span class="mh">0x0100</span><span class="p">,</span>
    <span class="n">RES_XML_END_NAMESPACE_TYPE</span>  <span class="o">=</span> <span class="mh">0x0101</span><span class="p">,</span>
    <span class="n">RES_XML_START_ELEMENT_TYPE</span>  <span class="o">=</span> <span class="mh">0x0102</span><span class="p">,</span>
    <span class="n">RES_XML_END_ELEMENT_TYPE</span>    <span class="o">=</span> <span class="mh">0x0103</span><span class="p">,</span>
    <span class="n">RES_XML_CDATA_TYPE</span>          <span class="o">=</span> <span class="mh">0x0104</span><span class="p">,</span>
    <span class="n">RES_XML_LAST_CHUNK_TYPE</span>     <span class="o">=</span> <span class="mh">0x017f</span><span class="p">,</span>
    <span class="c1">// This contains a uint32_t array mapping strings in the string
</span><span class="c1"></span>    <span class="c1">// pool back to resource identifiers.  It is optional.
</span><span class="c1"></span>    <span class="n">RES_XML_RESOURCE_MAP_TYPE</span>   <span class="o">=</span> <span class="mh">0x0180</span><span class="p">,</span>
    <span class="c1">// Chunk types in RES_TABLE_TYPE
</span><span class="c1"></span>    <span class="n">RES_TABLE_PACKAGE_TYPE</span>      <span class="o">=</span> <span class="mh">0x0200</span><span class="p">,</span>
    <span class="n">RES_TABLE_TYPE_TYPE</span>         <span class="o">=</span> <span class="mh">0x0201</span><span class="p">,</span>
    <span class="n">RES_TABLE_TYPE_SPEC_TYPE</span>    <span class="o">=</span> <span class="mh">0x0202</span><span class="p">,</span>
    <span class="n">RES_TABLE_LIBRARY_TYPE</span>      <span class="o">=</span> <span class="mh">0x0203</span>
<span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div>
<p>第二位headerSize表示当前Chunk的头部大小，第三位size表示当前Chunk的大小。</p>

<h3 id="2-2大小端">2.2大小端</h3>

<p>高位地址存高位数据，低位地址存低位数据，这称之为小端模式；反之称之为大端模式，resource.arsc文件采用的小端模式。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></pre></td>
<td class="lntd">
<pre class="chroma">00000000: 0200 0c00 5451 0900 0100 0000 0100 1c00  ....TQ..........
00000010: 5892 0100 3c0b 0000 0000 0000 0001 0000  X...&lt;...........
...</pre></td></tr></table>
</div>
</div>
<p>从上述数据我们可以看到，示例文件的块头部表示如下</p>

<table>
<thead>
<tr>
<th>name</th>
<th>value</th>
</tr>
</thead>

<tbody>
<tr>
<td>type</td>
<td>0x0002 (类型为 RES_TABLE_TYPE)</td>
</tr>

<tr>
<td>headerSize</td>
<td>12 (RES_TABLE_TYPE 的头部大小为 0x000c =&gt; 12字节)</td>
</tr>

<tr>
<td>size</td>
<td>610644 (整个文件字节数为 0x00095154 =&gt; 610644字节)</td>
</tr>
</tbody>
</table>

<h2 id="3-资源头部-resource-header">3.资源头部 Resource_Header</h2>



<div class="box">
<figure  itemprop="associatedMedia"
  itemscope itemtype="http://schema.org/ImageObject" >
    <div class="img">
      <img itemprop="thumbnail" src="/imgs/Resource_Header.png" />
    </div>
    <a href="/imgs/Resource_Header.png" itemprop="contentUrl"></a>
      <figcaption><h4>Resource_Header</h4>
      </figcaption>
  </figure>
</div>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-C++" data-lang="C++"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-C++" data-lang="C++"><span class="k">struct</span> <span class="n">ResTable_header</span><span class="p">{</span>
    <span class="k">struct</span> <span class="n">ResChunk_header</span> <span class="n">header</span><span class="p">;</span>
    <span class="n">uint32_t</span> <span class="n">packageCount</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div>
<p>这里我们开始正式分析，先看资源头部，从上图我们得知，资源头部Resource_Header 就是一个块头部加上一个packages字段。packages表示
了后续的Packages的数量，这里可以看到为0x0000 0001，也就是1个，通常一个工程都对应一个。最后从示例文件中分析，整个资源头部信息如下</p>

<table>
<thead>
<tr>
<th>name</th>
<th>value</th>
</tr>
</thead>

<tbody>
<tr>
<td>type</td>
<td>类型为 RES_TABLE_TYPE</td>
</tr>

<tr>
<td>headerSize</td>
<td>12 字节</td>
</tr>

<tr>
<td>size</td>
<td>610644  字节</td>
</tr>

<tr>
<td>packages</td>
<td>1</td>
</tr>
</tbody>
</table>

<h2 id="4-字符串资源池-global-string-pool">4.字符串资源池 Global_String_Pool</h2>



<div class="box">
<figure  itemprop="associatedMedia"
  itemscope itemtype="http://schema.org/ImageObject" >
    <div class="img">
      <img itemprop="thumbnail" src="/imgs/Global_String_Pool.png" />
    </div>
    <a href="/imgs/Global_String_Pool.png" itemprop="contentUrl"></a>
      <figcaption><h4>Global_String_Pool</h4>
      </figcaption>
  </figure>
</div>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-C++" data-lang="C++"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-C++" data-lang="C++"><span class="k">struct</span> <span class="n">ResStringPool_header</span>
<span class="p">{</span>
    <span class="k">struct</span> <span class="n">ResChunk_header</span> <span class="n">header</span><span class="p">;</span>
    <span class="n">uint32_t</span> <span class="n">stringCount</span><span class="p">;</span><span class="c1">//表示字符串数量
</span><span class="c1"></span>    <span class="n">uint32_t</span> <span class="n">styleCount</span><span class="p">;</span><span class="c1">//表示style的数量
</span><span class="c1"></span>    <span class="k">enum</span> <span class="p">{</span>
        <span class="n">SORTED_FLAG</span> <span class="o">=</span> <span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">UTF8_FLAG</span> <span class="o">=</span> <span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">8</span>
    <span class="p">};</span>
    <span class="n">uint32_t</span> <span class="n">flags</span><span class="p">;</span><span class="c1">//是否使用UTF-8方式读取
</span><span class="c1"></span>    <span class="n">uint32_t</span> <span class="n">stringsStart</span><span class="p">;</span><span class="c1">//字符数组首地址到头部首地址的距离
</span><span class="c1"></span>    <span class="n">uint32_t</span> <span class="n">stylesStart</span><span class="p">;</span><span class="c1">//style数组首地址到头部地址的距离
</span><span class="c1"></span><span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div>
<p>从Global_String_Pool的数据结构中，我们知道，想要获取字符串池中的数据，就要使用到图中所示的偏移数组（String Offset Array）。
偏移数组中保存的是图中Strings 相应顺序字符串的内存地址的偏移，这个偏移的参照就是Strings的首地址,首地址可以通过下列公式得到</p>

<p>$$ StringsAddr = HeaderAddr+stringsStart $$</p>

<p>也就是Strings的地址等于头部header地址加上stringsStart字段表示的数值。然后我们计算每个字符串的起始地址,图中SOA是String Offset Array的简写。</p>

<p>$$ Strings[i]Addr = SOA[i] + StringsAddr + 2 $$</p>

<p>公式中Strings[i]Addr表示字符串数组中的某一块数据，其地址是SOA和StringsAddr一起计算的，并且加上2是因为每一块的前两个字节表示
字符串的长度。获得了地址之后直接交给 print方法，就能正确输出。</p>

<p>实现代码如下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-C++" data-lang="C++"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-C++" data-lang="C++"><span class="n">uint32_t</span> <span class="n">size</span> <span class="o">=</span> <span class="n">header</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">size</span> <span class="o">-</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">ResStringPool_header</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">pData</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">size</span><span class="p">);</span>
<span class="n">fread</span><span class="p">((</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="n">pData</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pFile</span><span class="p">);</span>
<span class="n">uint32_t</span><span class="o">*</span> <span class="n">pOffsets</span> <span class="o">=</span> <span class="p">(</span><span class="n">uint32_t</span><span class="o">*</span><span class="p">)</span><span class="n">pData</span><span class="p">;</span>
<span class="c1">//pData的地址表示header的尾部地址，所以需要减去header的大小
</span><span class="c1"></span><span class="kt">char</span><span class="o">*</span> <span class="n">pStringsStart</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)(</span><span class="n">pData</span> <span class="o">+</span> <span class="n">header</span><span class="p">.</span><span class="n">stringsStart</span> <span class="o">-</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">ResStringPool_header</span><span class="p">));</span>
<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">header</span><span class="p">.</span><span class="n">stringCount</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//前面两个字节是长度,要跳过
</span><span class="c1"></span>    <span class="kt">char</span><span class="o">*</span> <span class="n">str</span> <span class="o">=</span> <span class="n">pStringsStart</span> <span class="o">+</span> <span class="o">*</span><span class="p">(</span><span class="n">pOffsets</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">header</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">ResStringPool_header</span><span class="o">::</span><span class="n">UTF8_FLAG</span><span class="p">)</span> <span class="p">{</span>
	    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">//如果不是UTF-8的存储方式，需要经过特殊处理才能打印
</span><span class="c1"></span>        <span class="n">printUtf16String</span><span class="p">((</span><span class="kt">char16_t</span><span class="o">*</span><span class="p">)</span><span class="n">str</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>
<h2 id="5-资源详情-package">5.资源详情 Package</h2>

<h3 id="5-1-资源详情头部-package-header">5.1 资源详情头部 Package_Header</h3>



<div class="box">
<figure  itemprop="associatedMedia"
  itemscope itemtype="http://schema.org/ImageObject" >
    <div class="img">
      <img itemprop="thumbnail" src="/imgs/Package_Header.png" />
    </div>
    <a href="/imgs/Package_Header.png" itemprop="contentUrl"></a>
      <figcaption><h4>Package_Header</h4>
      </figcaption>
  </figure>
</div>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-C++" data-lang="C++"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-C++" data-lang="C++"><span class="k">struct</span> <span class="n">ResTable_package</span>
<span class="p">{</span>
    <span class="k">struct</span> <span class="n">ResChunk_header</span> <span class="n">header</span><span class="p">;</span>
    <span class="n">uint32_t</span> <span class="n">id</span><span class="p">;</span>
    <span class="n">uint16_t</span> <span class="n">name</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span>
    <span class="n">uint32_t</span> <span class="n">typeStrings</span><span class="p">;</span>
    <span class="n">uint32_t</span> <span class="n">lastPublicType</span><span class="p">;</span>
    <span class="n">uint32_t</span> <span class="n">keyStrings</span><span class="p">;</span>
    <span class="n">uint32_t</span> <span class="n">lastPublicKey</span><span class="p">;</span>
    <span class="n">uint32_t</span> <span class="n">typeIdOffset</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div>
<p>对示例文件进行解析，得到如下结果</p>

<table>
<thead>
<tr>
<th>feild</th>
<th>value</th>
<th>feild</th>
<th>value</th>
</tr>
</thead>

<tbody>
<tr>
<td>type</td>
<td>512</td>
<td>typeStrings</td>
<td>288</td>
</tr>

<tr>
<td>headSize</td>
<td>288</td>
<td>lastPublicType</td>
<td>0</td>
</tr>

<tr>
<td>size</td>
<td>507632</td>
<td>keyStrings</td>
<td>572</td>
</tr>

<tr>
<td>id</td>
<td>7f</td>
<td>lastPublicKey</td>
<td>0</td>
</tr>

<tr>
<td>name</td>
<td>com.zgh.main</td>
<td>typeIdOffset</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>name字段记录了资源关联的包名。</p>

<p>id值为7f，这个id就是我们在R.java文件中经常见到一个资源id中的高两位</p>

<p>$$ pp-tt-eeee  $$</p>

<p>比如一个资源id为 0x7f010000，符合0xpptteeee格式，头部这个id就是代表 pp 的部分。并且默认从7f开始
前面的数字是用于系统资源。</p>

<p>再看typeStrings字段和keyStrings字段，这里首先需要知道，头部之后会存储资源的类型和具体资源名两个数据集合，
这两个字段分别表示集合首地址距离头部的首地址的偏移量。这里我们可以计算一下。</p>

<p>首先看typeStrings 为288，表示类型集合距离头部首地址288字节，其实也可以通过头部大小来明白这个值是准确的，头部大小也为
288，而头部之后就是类型集合。</p>

<p>再看keyStrings 为572，表示资源名集合距离头部首地址572，资源名集合位于类型集合之后，我们看看类型集合的大小</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">=====================types=====================
type:1, headSize:28, size:284, stringCount:14, stringStart:84, flags:0,styleCount:0, styleStart:0</pre></td></tr></table>
</div>
</div>
<p>可以看到类型集合大小size为284 ，刚好符合。</p>

<p>$$   284 + 288 = 572     $$</p>

<h3 id="5-2-资源字符信息池">5.2 资源字符信息池</h3>



<div class="box">
<figure  itemprop="associatedMedia"
  itemscope itemtype="http://schema.org/ImageObject" >
    <div class="img">
      <img itemprop="thumbnail" src="/imgs/Global_String_Pool.png" />
    </div>
    <a href="/imgs/Global_String_Pool.png" itemprop="contentUrl"></a>
  </figure>
</div>


<p>头部之后就是两个字符串池，保存的分别是类型名集合和资源名集合。两者在存储结构上跟前文介绍的全局字符串池一样，所以可以直接根据之前的理解读取</p>

<h4 id="5-2-1-资源类型字符串池-res-type-string-pool">5.2.1 资源类型字符串池 Res_Type_String_Pool</h4>

<p>我们可以大致先看看类型集合内容</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></pre></td>
<td class="lntd">
<pre class="chroma">anim
animator
array
attr
bool
color
dimen
drawable
id
integer
layout
raw
string
style</pre></td></tr></table>
</div>
</div>
<p>这个集合内容主要表示资源中使用或者涉及的类型，并且这个顺序是后边获取具体的资源项的顺序，是规定好的。</p>

<h4 id="5-2-2-资源项名称字符串池-res-name-string-pool">5.2.2 资源项名称字符串池 Res_Name_String_Pool</h4>

<p>再看资源名集合的内容</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></pre></td>
<td class="lntd">
<pre class="chroma">...
abc_fade_in
abc_fade_out
abc_grow_fade_in_from_bottom
abc_popup_enter
abc_popup_exit
abc_shrink_fade_out_from_bottom
abc_slide_in_bottom
abc_slide_in_top
abc_slide_out_bottom
abc_slide_out_top
common_push_bottom_in
common_push_bottom_out
...</pre></td></tr></table>
</div>
</div>
<p>输出内容是对应类型名集合中的顺序，依次将相应类型的资源顺序输出，并且这个顺序也是后边遍历具体资源配置的顺序。</p>

<h3 id="5-3-资源配置">5.3 资源配置</h3>

<p>最后了解资源具体配置之前，我们要明白这一部分的数据大致存储结构</p>



<div class="box">
<figure  itemprop="associatedMedia"
  itemscope itemtype="http://schema.org/ImageObject" >
    <div class="img">
      <img itemprop="thumbnail" src="/imgs/typeconfig_flow.png" />
    </div>
    <a href="/imgs/typeconfig_flow.png" itemprop="contentUrl"></a>
  </figure>
</div>


<p>一个Type_Spec开头，后边会紧跟若干个同类型的TypeConfig，Type_Spec的顺序就是前文Res_Type_String_Pool中的顺序。</p>

<h4 id="5-3-1-资源-type-spec">5.3.1 资源 Type_Spec</h4>



<div class="box">
<figure  itemprop="associatedMedia"
  itemscope itemtype="http://schema.org/ImageObject" >
    <div class="img">
      <img itemprop="thumbnail" src="/imgs/Type_Spec.png" />
    </div>
    <a href="/imgs/Type_Spec.png" itemprop="contentUrl"></a>
      <figcaption><h4>Type_Spec</h4>
      </figcaption>
  </figure>
</div>


<p>id表示类型id，就是0xpptteeee格式中的tt部分。</p>

<p>这里重点介绍entryCount，entryCount表明当前类型下的资源的数量，比如anim资源的数量。</p>

<p>随后紧跟随的数据集合，就是Res_Name_String_Pool中具体资源的配置编码，这个编码有特殊含义,表明该项资源的取值会受到哪些配置影响（这些配置包括
横竖屏，国际化，sdk版本等）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-C++" data-lang="C++"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-C++" data-lang="C++">    <span class="n">ACONFIGURATION_MCC</span> <span class="o">=</span> <span class="mh">0x0001</span><span class="p">,</span>
    <span class="n">ACONFIGURATION_MNC</span> <span class="o">=</span> <span class="mh">0x0002</span><span class="p">,</span>
    <span class="n">ACONFIGURATION_LOCALE</span> <span class="o">=</span> <span class="mh">0x0004</span><span class="p">,</span>
    <span class="n">ACONFIGURATION_TOUCHSCREEN</span> <span class="o">=</span> <span class="mh">0x0008</span><span class="p">,</span>

    <span class="n">ACONFIGURATION_KEYBOARD</span> <span class="o">=</span> <span class="mh">0x0010</span><span class="p">,</span>
    <span class="n">ACONFIGURATION_KEYBOARD_HIDDEN</span> <span class="o">=</span> <span class="mh">0x0020</span><span class="p">,</span>
    <span class="n">ACONFIGURATION_NAVIGATION</span> <span class="o">=</span> <span class="mh">0x0040</span><span class="p">,</span>
    <span class="n">ACONFIGURATION_ORIENTATION</span> <span class="o">=</span> <span class="mh">0x0080</span><span class="p">,</span>
    
    <span class="n">ACONFIGURATION_DENSITY</span> <span class="o">=</span> <span class="mh">0x0100</span><span class="p">,</span>
    <span class="n">ACONFIGURATION_SCREEN_SIZE</span> <span class="o">=</span> <span class="mh">0x0200</span><span class="p">,</span>
    <span class="n">ACONFIGURATION_VERSION</span> <span class="o">=</span> <span class="mh">0x0400</span><span class="p">,</span>
    <span class="n">ACONFIGURATION_SCREEN_LAYOUT</span> <span class="o">=</span> <span class="mh">0x0800</span><span class="p">,</span>
    
    <span class="n">ACONFIGURATION_UI_MODE</span> <span class="o">=</span> <span class="mh">0x1000</span><span class="p">,</span>
    <span class="n">ACONFIGURATION_SMALLEST_SCREEN_SIZE</span> <span class="o">=</span> <span class="mh">0x2000</span><span class="p">,</span>
    <span class="n">ACONFIGURATION_LAYOUTDIR</span> <span class="o">=</span> <span class="mh">0x4000</span><span class="p">,</span>
</code></pre></td></tr></table>
</div>
</div>
<p>在代码配置中，如上边的代码所示，每一项配置是占位配置，不是递增配置，这样就可以用一个数据块表明几个配置项。
比如某个资源的获取受到了屏幕大小（ACONFIGURATION_SCREEN_SIZE）和sdk版本（ACONFIGURATION_VERSION）两者的影响
那么这配置项就等于</p>

<p>$$  0x0200 + 0x0400 = 0x0600    $$</p>

<p>同时没用最高位0x8000这一项，因为最后最高位被置为1时，表示这个资源已经成为公共资源，能够被外部引用。</p>

<h4 id="5-3-2-资源-typeconfig">5.3.2 资源 TypeConfig</h4>



<div class="box">
<figure  itemprop="associatedMedia"
  itemscope itemtype="http://schema.org/ImageObject" >
    <div class="img">
      <img itemprop="thumbnail" src="/imgs/TypeConfig.png" />
    </div>
    <a href="/imgs/TypeConfig.png" itemprop="contentUrl"></a>
      <figcaption><h4>TypeConfig_header</h4>
      </figcaption>
  </figure>
</div>


<p>前面我们提到了一个Type_Spec后边会跟几个TypeConfig，每个TypeConfig不同的地方就是config不同，在图中我们看到中间区域在源码定义为
ResTable_config，ResTable_config用来表示该块TypeConfig主要受什么配置影响，比如TypeConfig受sdk版本影响，那么后续的
config entry array 存储的就是受sdk版本影响的资源项。</p>

<p>比如res文件夹下有values 和 values-v24这两个文件夹，value下有string资源 origin_name ，值为 “value”，value-v24下也有string资源 origin_name，值为“value-v24”</p>

<p>那么origin_name这个字段就会在 config 分别为 默认情况和 config: v24两个TypeConfig下面都出现。</p>

<p>头部id表示当前TypeConfig属于哪个Type_Spec，id 跟 Type_Spec的id是相等的。</p>

<p>然后我们再看偏移数组，entryCount和entriesStart分别表示资源个数，资源数组的相对于头部的偏移，这块其实跟前面的偏移数组计算方式一样，不再多说。</p>

<p>最后我们再看具体的资源分布。</p>



<div class="box">
<figure  itemprop="associatedMedia"
  itemscope itemtype="http://schema.org/ImageObject" >
    <div class="img">
      <img itemprop="thumbnail" src="/imgs/ResTableEntry.png" />
    </div>
    <a href="/imgs/ResTableEntry.png" itemprop="contentUrl"></a>
      <figcaption><h4>ResTableEntry</h4>
      </figcaption>
  </figure>
</div>




<div class="box">
<figure  itemprop="associatedMedia"
  itemscope itemtype="http://schema.org/ImageObject" >
    <div class="img">
      <img itemprop="thumbnail" src="/imgs/ResTableMapEntry.png" />
    </div>
    <a href="/imgs/ResTableMapEntry.png" itemprop="contentUrl"></a>
      <figcaption><h4>ResTableMapEntry</h4>
      </figcaption>
  </figure>
</div>


<p>ResTableMapEntry 继承于 ResTableEntry，我们先看两者的公共部分，index表示是该项资源在Res_Name_String_Pool中的位置。
flags用来区分该部分数据为ResTableEntry还是ResTableMapEntry，data就是资源value值。</p>

<p>ResTableEntr用来表示一条简单的资源项，比如一条string的表示如下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></pre></td>
<td class="lntd">
<pre class="chroma">&lt;string name=&#34;arsc_name&#34;&gt;v16demo&lt;/string&gt;

==============================================

entryIndex: 0x28, key :

arsc_name 		

value :(string) v16demo</pre></td></tr></table>
</div>
</div>
<p>而ResTableMapEntry用来表示比较多的配置项，比如style中的资源</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></pre></td>
<td class="lntd">
<pre class="chroma">&lt;style name=&#34;AppTheme&#34; parent=&#34;Theme.AppCompat.Light.DarkActionBar&#34;&gt;
    &lt;item name=&#34;colorPrimary&#34;&gt;@color/colorPrimarynew&lt;/item&gt;
    &lt;item name=&#34;colorPrimaryDark&#34;&gt;@color/colorPrimaryDark&lt;/item&gt;
    &lt;item name=&#34;colorAccent&#34;&gt;@color/colorAccent&lt;/item&gt;
&lt;/style&gt;


==============================================

entryIndex: 0x45, key :
AppTheme
			name:0x7f02004e, valueType:1, value:2130968614
			name:0x7f020055, valueType:1, value:2130968616
			name:0x7f020056, valueType:1, value:2130968615</pre></td></tr></table>
</div>
</div>
<p>最后我们再次讨论一下一个资源的id组成，比如我在一个string资源中定义了arsc_name，在R.java文件中我我们找到了</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">        public static final int arsc_name = 2131427368;</pre></td></tr></table>
</div>
</div>
<p>转化成十六进制为0x7f0b0028，然后我们在arsc文件中去找是符合，entryIndex 为0x28，加上高位0x7f，加上Type_Spec id为 0x0b</p>

<p>$$   0xpp-tt-eeee   $$
$$   0x7f-0b-0028   $$</p>

<h2 id="总结">总结</h2>

<p>Resource.arsc文件包含了资源编译中的索引关系，结构紧凑，起到了一定的缩小apk包体积的作用。了解之后对于资源加载机制的理解也有很大帮助。
后边准备了参考解析源码，是网上某位大牛提供的，能够加深理解。</p>

<p><strong>参考源码</strong></p>

<p><a href="https://github.com/bluesky466/ResourcesArscDemo">https://github.com/bluesky466/ResourcesArscDemo</a></p>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">WangZoo</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
      2020-01-06
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">License</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://wang-zoo.github.io/tags/apk/">apk</a>
          <a href="https://wang-zoo.github.io/tags/%E6%8F%92%E4%BB%B6%E5%8C%96/">插件化</a>
          <a href="https://wang-zoo.github.io/tags/resource.arsc/">resource.arsc</a>
          
        </div>

      
      <nav class="post-nav">
        
        
          <a class="next" href="/post/view_traversal/">
            <span class="next-text nav-default">View 测绘分析</span>
            <span class="prev-text nav-mobile">Next</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  


<a href="https://wang-zoo.github.io/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2019 -
    2020
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        WangZoo
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>






  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css"
    integrity="sha384-BdGj8xC2eZkQaxoQ8nSLefg4AV4/AwB3Fj+8SUSo7pnKP6Eoy18liIKTPn9oBYNG"
    crossorigin="anonymous">

  
  <script defer
    src="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.js"
    integrity="sha384-JiKN5O8x9Hhs/UE5cT5AAJqieYlOZbGT3CHws/y97o3ty4R7/O5poG9F3JoiOYw1"
    crossorigin="anonymous"></script>

  
  <script defer
    src="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/contrib/auto-render.min.js"
    integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI"
    crossorigin="anonymous" onload="renderMathInElement(document.body);">
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
        
      });
    });
  </script>






  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  















</body>
</html>
